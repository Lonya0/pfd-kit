{
    "name":"example",
    "bohrium_config": {
        "username": "urname",
        "password": "123456",
        "project_id": 123456,
        "_comment": "all"
    },
    "default_step_config": {
        "template_config": {
            "image": "registry.dp.tech/dptech/deepmd-kit:2024Q1-d23cf3e"
        },
        "executor": {
            "type": "dispatcher",
            "image_pull_policy": "IfNotPresent",
            "machine_dict": {
                "batch_type": "Bohrium",
                "context_type": "Bohrium",
                "remote_profile": {
                    "input_data": {
                        "job_type": "container",
                        "platform": "ali",
                        "scass_type": "c2_m4_cpu"
                    }
                }
            }
        }
    },
    "step_configs": {
        "run_fp_config": {
            "template_config": {
                "image": "registry.dp.tech/dptech/abacus:3.6.1",
                "retry_on_transient_error": 1
            },
            "continue_on_failed":true,
            "continue_on_success_ratio": 0.9,
            "executor": {
                "type": "dispatcher",
                "image_pull_policy": "IfNotPresent",
                "machine_dict": {
                    "batch_type": "Bohrium",
                    "context_type": "Bohrium",
                    "remote_profile": {
                        "input_data": {
                            "job_type": "container",
                            "platform": "ali",
                            "scass_type": "c32_m64_cpu"
                        }
                    }
                }
            }
        },
        "run_explore_config": {
            "template_config": {
                "image": "registry.dp.tech/dptech/deepmd-kit:2024Q1-d23cf3e"
            },
            "continue_on_success_ratio": 0.8,
            "executor": {
                "type": "dispatcher",
                "image_pull_policy": "IfNotPresent",
                "machine_dict": {
                    "batch_type": "Bohrium",
                    "context_type": "Bohrium",
                    "remote_profile": {
                        "input_data": {
                            "job_type": "container",
                            "platform": "ali",
                            "scass_type": "1 * NVIDIA V100_32g"
                        }
                    }
                }
            }
        },
        "run_train_config": { 
            "template_config": {
                "image": "registry.dp.tech/dptech/deepmd-kit:2024Q1-d23cf3e"
            },
            "executor": {
                "type": "dispatcher",
                "retry_on_submission_error": 10,
                "image_pull_policy": "IfNotPresent",
                "machine_dict": {
                    "batch_type": "Bohrium",
                    "context_type": "Bohrium",
                    "remote_profile": {
                        "input_data": {
                            "job_type": "container",
                            "platform": "ali",
                            "scass_type": "1 * NVIDIA V100_32g"
                        }
                    }
                }
            }
        },
        "inference_config": { 
            "template_config": {
                "image": "registry.dp.tech/dptech/deepmd-kit:2024Q1-d23cf3e"
            },
            "executor": {
                "type": "dispatcher",
                "retry_on_submission_error": 10,
                "image_pull_policy": "IfNotPresent",
                "machine_dict": {
                    "batch_type": "Bohrium",
                    "context_type": "Bohrium",
                    "remote_profile": {
                        "input_data": {
                            "job_type": "container",
                            "platform": "ali",
                            "scass_type": "1 * NVIDIA V100_32g"
                        }
                    }
                }
            }
        }
    },
    "upload_python_packages": [
        "/opt/mamba/envs/openlam/lib/python3.12/site-packages/dpgen2",
        "/opt/mamba/envs/openlam/lib/python3.12/site-packages/dpdata",
        "/opt/mamba/envs/openlam/lib/python3.12/site-packages/fpop"

    ],
    "inputs": {
        "type_map": [
            "H",
            "He",
            "Li",
            "Be",
            "B",
            "C",
            "N",
            "O",
            "F",
            "Ne",
            "Na",
            "Mg",
            "Al",
            "Si",
            "P",
            "S",
            "Cl",
            "Ar",
            "K",
            "Ca",
            "Sc",
            "Ti",
            "V",
            "Cr",
            "Mn",
            "Fe",
            "Co",
            "Ni",
            "Cu",
            "Zn",
            "Ga",
            "Ge",
            "As",
            "Se",
            "Br",
            "Kr",
            "Rb",
            "Sr",
            "Y",
            "Zr",
            "Nb",
            "Mo",
            "Tc",
            "Ru",
            "Rh",
            "Pd",
            "Ag",
            "Cd",
            "In",
            "Sn",
            "Sb",
            "Te",
            "I",
            "Xe",
            "Cs",
            "Ba",
            "La",
            "Ce",
            "Pr",
            "Nd",
            "Pm",
            "Sm",
            "Eu",
            "Gd",
            "Tb",
            "Dy",
            "Ho",
            "Er",
            "Tm",
            "Yb",
            "Lu",
            "Hf",
            "Ta",
            "W",
            "Re",
            "Os",
            "Ir",
            "Pt",
            "Au",
            "Hg",
            "Tl",
            "Pb",
            "Bi",
            "Po",
            "At",
            "Rn",
            "Fr",
            "Ra",
            "Ac",
            "Th",
            "Pa",
            "U",
            "Np",
            "Pu",
            "Am",
            "Cm",
            "Bk",
            "Cf",
            "Es",
            "Fm",
            "Md",
            "No",
            "Lr",
            "Rf",
            "Db",
            "Sg",
            "Bh",
            "Hs",
            "Mt",
            "Ds",
            "Rg",
            "Cn",
            "Nh",
            "Fl",
            "Mc",
            "Lv",
            "Ts",
            "Og"
        ],
        "init_data_sys":[],
        "_comment": "you can set 'init_data_sys' or 'init_data_url'"
    },
    "conf_generation": {
        "init_configurations":
            {
            "type": "file",
            "prefix": "./",
            "fmt": "vasp/poscar",
            "files": [
                    "LGPS.vasp"
                ]},
            
        "pert_generation":[
            {
            "conf_idx": "default",
            "atom_pert_distance":0.15,
            "cell_pert_fraction":0.03,
            "pert_num": 5
            }
            ],
        "test_data":0.1,
        "system_partition": true,
        "exploration": {
            "md":{
                "type": "lmp",
                "model":"./model.ckpt-500000.pt",
                "config": {
                    "command": "lmp -var restart 0",
                    "shuffle_models": false, 
                    "head": null
                },
                "task_groups":[
                {
                    "_comment": "group 1, short MD with pretrained or finetuned model",
                    "conf_idx": [0],
                    "n_sample":2,
                    "exploration":{
                        "type": "lmp-md",
                        "ensemble": "npt",
                        "dt":0.005,
                        "nsteps": 40,
                        "temps": [900],
                        "press":[1],
                        "trj_freq": 20
                    },
                    "max_sample": 10000}],
                "max_iter":2
                },
            "skip_aimd":true,
            "aimd":{
                "fp":{
                    "type": "fpop_abacus",
                    "task_max": 50,
                    "run_config": {
                        "command": "OMP_NUM_THREADS=4 mpirun -np 8 abacus | tee log"
                    },
                    "inputs_config": {
                        "input_file": "INPUT.scf",
                        "pp_files": {
                            "Li": "./pp/Li_ONCV_PBE-1.0.upf",
                            "S":"./pp/S_ONCV_PBE-1.0.upf",
                            "Ge": "./pp/Ge_ONCV_PBE-1.0.upf",
                            "P": "./pp/P_ONCV_PBE-1.0.upf"
                        },
                        "orb_files":{
                            "Li": "./orb/Li_gga_9au_100Ry_6s2p.orb",
                            "S":"./orb/S_gga_9au_100Ry_3s3p2d.orb",
                            "Ge": "./orb/Ge_gga_9au_100Ry_3s3p3d2f.orb",
                            "P": "./orb/P_gga_9au_100Ry_3s3p2d.orb"
                        }
                    },
                    "_comment": "fp parameters for calculation"
                }
            }
                },
        "_comment": "set 'skip_aimd' to true if not needed"
    },
    "inference":{
    },
    "fp": {
        "type": "fpop_abacus",
        "task_max": 50,
        "run_config": {
            "command": "OMP_NUM_THREADS=4 mpirun -np 8 abacus | tee log"
        },
        "inputs_config": {
            "input_file": "INPUT.scf",
            "pp_files": {
                "Li": "./pp/Li_ONCV_PBE-1.0.upf",
                "S":"./pp/S_ONCV_PBE-1.0.upf",
                "Ge": "./pp/Ge_ONCV_PBE-1.0.upf",
                "P": "./pp/P_ONCV_PBE-1.0.upf"
            },
            "orb_files":{
                "Li": "./orb/Li_gga_9au_100Ry_6s2p.orb",
                "S":"./orb/S_gga_9au_100Ry_3s3p2d.orb",
                "Ge": "./orb/Ge_gga_9au_100Ry_3s3p3d2f.orb",
                "P": "./orb/P_gga_9au_100Ry_3s3p2d.orb"
            }
        },
        "_comment": "fp parameters for calculation"
    },
    "aimd":{
            "type": "fpop_abacus",
            "task_max": 50,
            "run_config": {
                "command": "OMP_NUM_THREADS=4 mpirun -np 8 abacus | tee log"
                },
            "inputs_config": {
                        "input_file": "INPUT.scf",
                        "pp_files": {
                            "Li": "./pp/Li_ONCV_PBE-1.0.upf",
                            "S":"./pp/S_ONCV_PBE-1.0.upf",
                            "Ge": "./pp/Ge_ONCV_PBE-1.0.upf",
                            "P": "./pp/P_ONCV_PBE-1.0.upf"
                        },
                        "orb_files":{
                            "Li": "./orb/Li_gga_9au_100Ry_6s2p.orb",
                            "S":"./orb/S_gga_9au_100Ry_3s3p2d.orb",
                            "Ge": "./orb/Ge_gga_9au_100Ry_3s3p3d2f.orb",
                            "P": "./orb/P_gga_9au_100Ry_3s3p2d.orb"
                        }
                    },
                    "_comment": "fp parameters for AIMD calculation"
                },
    "train": {
        "comment":"Training script for downstream DeePMD model",
        "type": "dp",
        "config": {
            "impl": "pytorch",
            "init_model_policy": "no",
            "init_model_with_finetune":true,
            "_comment": "all"
        },
        "template_script": "train.json",
        "init_models_url":"oss://13756/18739/store/upload/bc88f4a6-68e0-4450-84e3-c19c2930744c/tmpyt77_qpv.tgz",
        "numb_models":1,
        "_comment": "the initial pre-trained model at 'init_models_paths'"
    }
}
